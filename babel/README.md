# 💻 바벨(Babel)

## 📄 목차

1. [크로스 브라우징](#크로스-브라우징)
2. [트랜스파일과 빌드](#트랜스파일과-빌드)
3. [바벨의 기본 동작](#바벨의-기본-동작)
4. [플러그인](#플러그인)

### 🤓 참고

<br />

## 📝 배경

### 크로스 브라우징

- 브라우저마다 사용하는 언어가 달라서 프론트엔드 코드는 일관적이지 못할때가 많다.
- 프론트엔드 개발에서 크로스브라우징 이슈는 코드의 일관성을 해치고 초심자를 힘들게하는 요소이다.
- 이런 크로스 브라우징의 혼란을 해결해 줄 수 있는 것이 `바벨`이다. ECMAScript2015+로 작성한 코드를 모든 브라우저에서 동작하도록 호환성을 지켜준다. 타입스크립트, JSX처럼 다른 언어로 분류되는 것도 포함한다.

<br />

### 트랜스파일과 빌드

- 이렇게 변화 시켜주는 것을 `트랜스 파일`이라고 한다. 트랜스 파일은변환 전후의 추상화 수준이 다른 빌드와는 달리 트랜스 파일은 추상화 수준을 유지한 상태로 코드를 변환한다.
- 예로, `타입스크립트 -> 자바스크립트` or `JSX -> 자바스크립트`처럼 트랜스파일 후에도 여전히 코드를 읽을 수 있다.

<br />

## 📝 바벨의 기본 동작

- 바벨은 ECMAScript2015 이상의 코드를 적당한 하위 버전으로 바꾸는 것이 주된 역할이다.
- 이렇게 바뀐 코드는 IE와 같은 구버전 브라우저 처럼 최신 자바스크립트 코드를 이해하지 못하는 환경에서도 잘동작하게 해준다.

```js
const alert = (msg) => window.alert(msg);
```

- 위 예제를 IE가 이해할 수 있는 코드로 바꿔보자. 우선 바벨 최신 버전을 설치한다.
- 일반적으로 babel은 `@babel/core`와 커맨드로 실행할 수 있는 `@babel/cli`가 있다.

```
yarn add -D @babel/core @babel/cli
```

- 설치 완료 후 node_modules/.bin에 있는 babel을 실행해도 되지만 npx를 이용하면 더 쉽게 babel을 실행할 수 있다.

```
바벨 실행
npx babel app.js

결과
const alert = msg => window.alert(msg);
```

- 결과물이 나왔는데 딱히 변화된게 없어보인다. 참고로, 바벨은 세 단계로 빌드를 진행한다.
  1. 파싱(Parsing)
  2. 변환(Transforming)
  3. 출력(Printing)

<br />

- 코드를 읽고 `추상 구문 트리(AST)`로 변환하는 단계를 `파싱` 이라고 한다. 추상 구문 트리는 빌드 작업을 처리하기에 적합한 자료구조인데 컴파일러 이론에 사용되는 개념이다.
- 추상 구문 트리를 변경하는 것이 `변환` 단계이다. 실제로 코드를 변경하는 작업을 한다.
- 변경된 결과물을 `출력`하는 것을 마지막으로 바벨은 작업을 완료한다.
- 하지만 위 예제의 결과를 보면 빌드 이전과 변한게 하나도 없다. 그 이유를 아래에서 알아보자.

<br />

## 📝 플러그인

- 기본적으로 바벨은 코드를 받아서 코드를 반환한다. 바벨 함수를 정의한다면 이런 모습이다.

```js
const babel = (code) => code;
```
